# 外部データソース調査メモ

## 候補API一覧
- **気象庁 防災情報XML・JSON API**（気象庁）
- **OpenWeather One Call 3.0 / Current & Forecast API**（OpenWeather）
- **EventRegist REST API**（イベントレジスト株式会社）

## サービス比較表
| サービス | 主な提供データ | 料金プランの目安 | レート制限/利用制約 | サンプルレスポンス抜粋 | 対応地域 |
| --- | --- | --- | --- | --- | --- |
| 気象庁 防災情報XML・JSON API | 天気予報、警報・注意報、降水短時間予報、アメダス観測など | 無料（商用利用可）。利用規約で出典明記・二次配信時の注意義務あり | 明示的な制限はないが、ドキュメントで*1分に1回程度以下*のアクセスとキャッシュ利用を推奨。大量アクセス時はIP制限の可能性あり | `{"publishingOffice":"気象庁","timeSeries":[{"areas":[{"area":{"name":"東京地方"},"weatherCodes":["101"],"weathers":["晴れ 時々 くもり"],"winds":["北の風"],"waves":[""]}],"timeDefines":["2024-06-01T05:00:00+09:00"]}]}` | 日本国内（地方/府県/市町村単位） |
| OpenWeather API | 現在の天気、予報、履歴、One Callによる複合データ | Free: 月1,000コールまで無料。Starter: $40/月（100万コール含む）。Developer/Professional以上は$150〜$500/月。超過分は$0.001/call課金。商用利用は有料プラン推奨 | Free: 1分間60リクエスト、日1,000コール。Starter以上: 1分間3,000リクエスト上限、SLAあり。APIキー必須 | `{"lat":35.68,"lon":139.76,"current":{"temp":298.4,"weather":[{"id":800,"main":"Clear","description":"clear sky"}]},"hourly":[{"dt":1717200000,"temp":300.1,"weather":[{"id":801,"description":"few clouds"}]}]}` | 世界200,000都市以上、緯度経度指定でグローバル対応 |
| EventRegist REST API | イベント一覧、参加者管理、チェックイン、注文情報 | 無料プランはAPI非提供。Business/Enterprise契約（要問い合わせ）。初期費用10万円〜、月額3万円〜が目安。API利用はNDA締結と審査が必要 | 公式ドキュメントで1アプリあたり1分間600リクエストまでを推奨。APIキーとクライアントシークレットでOAuth認証。Sandbox環境あり | `{"events":[{"id":"12345","title":"Tech Meetup Tokyo","starts_at":"2024-06-12T18:30:00+09:00","venue":{"name":"虎ノ門ヒルズ"},"status":"published"}]}` | 主にEventRegist上で公開されたイベント（日本国内が中心、海外イベントは限定的） |

## プロダクション利用時の契約・コスト試算
### 気象庁 防災情報XML・JSON API
- **契約/手続き**: 申請不要。利用規約に従い出典表記（例:「気象庁予報データを加工して表示」）を明示し、データ改変時の責任を負う必要がある。
- **運用留意点**: 取得頻度を制御し、ローカルキャッシュやスケジューラ（例: 10分間隔）で更新。大量アクセスが見込まれる場合はCDNや自社キャッシュで配布。
- **概算コスト**: API利用料は無料。インフラ（キャッシュ/監視）費のみ。

### OpenWeather API
- **契約/手続き**: アカウント登録とクレジットカード登録で即利用可。商用公開はStarter以上（$40/月）の有料サブスクリプションが推奨。SLA/拡張サポートはProfessional以上で個別契約。
- **概算コスト試算**（例: 1都市の現在・1時間予報を5分間隔で取得、日288回）
  - Free枠: 288コール/日 → 1,000コール/日の範囲内。ただし商用公開不可の可能性があるため要注意。
  - Starterプラン: 月$40で100万コールまで含むため、288×30=8,640コール/月は余裕。追加コストなし。
  - 超過課金: 100万コール超過時は $0.001/コール。
- **その他**: HTTPS必須、利用規約でOpenWeatherロゴ/リンク表示が推奨。キャッシュ最大10分。

### EventRegist REST API
- **契約/手続き**: BusinessもしくはEnterpriseプランでの法人契約が必要。API利用は別途申請・審査（利用目的・取扱データ範囲）を経てクライアント認証情報を発行。
- **概算コスト試算**（ヒアリングベースの一般的水準）
  - 初期費用: 10万円〜
  - 月額: 3万円〜（イベント数・機能により変動）
  - 大量トラフィックが必要な場合はEnterpriseプランで個別見積もり。
- **その他**: 参加者個人情報を扱うため、APIアクセスログ保存や暗号化通信、利用規約での個人情報保護体制が要求される。

## 優先順位と採用方針
1. **第一候補: 気象庁 防災情報XML・JSON API**
   - 完全無料で国内向け天気情報が揃う。更新頻度は高く、国データの信頼性も高い。
   - 実装コストも低いため、まずは気象庁データを基盤にする。
2. **第二候補（補完/拡張）: OpenWeather API**
   - グローバル対応や過去データ、気象庁にない指数系データを補完。ユーザー数増加や国外展開時に有料プランへアップグレード。
   - Freeプランでプロトタイプ検証 → 本番公開時はStarter以上に移行。
3. **バックアップ案: EventRegist REST API**
   - 気象データではなくイベント情報。イベント連携が必要な場合の補助的ソースとして検討。
   - 契約・コスト負担が大きいので、具体的なユースケースが固まった段階で導入判断。

## 今後のアクション
- 気象庁API: スキーマ調査とレスポンス解析を進め、必要なデータを抽出するパーサーを実装。
- OpenWeather: プロトタイプでFreeキーを発行し、実際のレスポンスとレート制限挙動を確認。
- EventRegist: ビジネス要件が確定したら営業窓口へ問い合わせ、利用審査・SLA条件を確認。
